{% extends 'base.html' %}
{% block title %}Box Manager{% endblock %}

{% block content %}
<div class="container">
  <h2 class="center-align">ðŸ“¦ Box Manager</h2>

  <div class="section center-align">
    <a href="{% url 'add_box' %}" class="btn green">
      <i class="fas fa-plus left"></i> Add New Box
    </a>
  </div>

  <div class="section">
    <h4>Existing Boxes</h4>
    <ul class="collection">
      {% for box in boxes %}
        <li class="collection-item">
          <div class="row row-no-margin">
            <div class="col s12 m6">
              <strong>{{ box.name }}</strong> â€” {{ box.shipping_date|date:"d M Y" }}
            </div>
            <div class="col s12 m6 right-align">
              <div class="secondary-content btn-group">
                <a href="{% url 'edit_box' box.id %}" class="btn-small">
                  <i class="fas fa-pencil-alt left"></i> Edit
                </a>
                <a href="{% url 'edit_box_products' box.id %}" class="btn-small blue">
                  <i class="fas fa-box-open left"></i> Products
                </a>
                <a href="{% url 'delete_box' box.id %}" class="btn-small red">
                  <i class="fas fa-trash-alt left"></i> Delete
                </a>
              </div>              
            </div>
          </div>
        </li>
      {% empty %}
        <li class="collection-item">No boxes available yet.</li>
      {% endfor %}
    </ul>
  </div>

  <div class="section">
    <h4>Orphaned Products (Unassigned)</h4>
    {% if orphaned_products %}
      <ul class="collection">
        {% for product in orphaned_products %}
          <li class="collection-item">
            <div class="row row-no-margin">
              <div class="col s12 m6">
                <strong>{{ product.name }}</strong> (x{{ product.quantity }})
              </div>
              <div class="col s12 m6 right-align">
                <div class="secondary-content btn-group">
                  <a href="{% url 'edit_product' product.id %}" class="btn-small">
                    <i class="fas fa-edit left"></i> Edit
                  </a>
                  <a href="{% url 'delete_product' product.id %}" class="btn-small red">
                    <i class="fas fa-trash-alt left"></i> Delete
                  </a>
                </div>
              </div>
            </div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="grey-text">No orphaned products found.</p>
    {% endif %}
  </div>

  <div class="section center-align">
    <a href="{% url 'add_products' %}" class="btn blue waves-effect">
      <i class="fas fa-plus left"></i> Add Product
    </a>
  </div>
  
{% endblock %}
